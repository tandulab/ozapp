import{u as j,T as m,L as Q,g as q,p as G,a as H,s as J,b as W,c as X,A as Y}from"./role95584.js";import{d as S,j as T,r as D,b as L,o as r,e as g,w as l,u as s,k as Z,f as t,a as n,l as k,n as v,c as y,t as b,p as ee,F as te,q as ae,v as M,x as oe,T as se}from"../index95584.js";import{s as le}from"./index955843.js";import{s as ne}from"./index955844.js";import{u as z}from"./user95584.js";import{u as ie}from"./settings95584.js";import"./index955842.js";const re={class:"flex items-center gap-x-2"},ce={class:"flex items-center gap-2"},ue=["src"],de={class:"flex items-center gap-x-2"},pe={class:"flex items-center gap-x-2"},me={class:"flex items-center gap-x-2"},ve={class:"flex items-center justify-center"},C=10,fe=S({__name:"UserTable",setup(B){const c=z(),u=ie(),{users:f,totalUsers:h}=T(c),{onSort:w,onPage:U,onFilter:E,loadLazyData:K,isLoading:R}=j({rows:C},N),x=D({id:{value:"",matchMode:m.EQ},email:{value:"",matchMode:m.LIKE},category_id:{value:"",matchMode:m.EQ},role:{value:"",matchMode:m.EQ},full_name:{value:"",matchMode:m.LIKE}});function A(){E(x.value)}async function N(_){try{await c.fetchUsers(_)}catch(i){console.error(i)}}const I=function(_){return{name:M.utentiDettaglio,params:{id:_}}};return L(()=>{K()}),(_,i)=>{const V=ne,d=oe,O=le,p=J,F=W,$=X,P=se;return r(),g(Q,{value:s(f),rows:C,"total-records":s(h),onSort:s(w),onPage:s(U),onFilter:A,filters:x.value,"onUpdate:filters":i[0]||(i[0]=e=>x.value=e),"data-key":"id",scrollable:"",loading:s(R),showGridlines:"",rowHover:!0},{empty:l(()=>i[1]||(i[1]=[Z("Non ci sono utenti")])),default:l(()=>[t(p,{class:"min-w-[200px]","filter-field":"full_name",header:"Utente",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:l(({filterModel:e,filterCallback:o})=>[n("div",re,[t(V,{fluid:"",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,type:"text",placeholder:"Filtra",onKeydown:k(a=>o(),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeydown"]),t(d,{class:v(e.value?"":"invisible"),icon:"pi pi-filter-slash",variant:"text",rounded:"",onClick:a=>{e.value="",o()}},null,8,["class","onClick"])])]),body:l(({data:e})=>[n("div",ce,[e.profile_picture_url?(r(),y("img",{key:0,src:e.profile_picture_url,style:{width:"32px"}},null,8,ue)):(r(),g(O,{key:1,label:(e==null?void 0:e.first_name.charAt(0))+(e==null?void 0:e.last_name.charAt(0)),class:"mr-2 text-sm!",size:"width: 32px",shape:"circle"},null,8,["label"])),n("span",null,b(e.full_name),1)])]),_:1}),t(p,{class:"min-w-[200px]",header:"Email",field:"email",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:l(({filterModel:e,filterCallback:o})=>[n("div",de,[t(V,{fluid:"",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,type:"text",placeholder:"Filtra",onKeydown:k(a=>o(),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeydown"]),t(d,{class:v(e.value?"":"invisible"),icon:"pi pi-filter-slash",variant:"text",rounded:"",onClick:a=>{e.value="",o()}},null,8,["class","onClick"])])]),_:1}),t(p,{class:"min-w-[100px]",header:"Categoria",field:"category_id",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:l(({filterModel:e,filterCallback:o})=>[n("div",pe,[t(F,{class:"w-full",modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,o],options:s(u).getUserCategories(),"option-label":"labels.it","option-value":"value"},null,8,["modelValue","onUpdate:modelValue","options"]),t(d,{class:v(e.value?"":"invisible"),icon:"pi pi-filter-slash",variant:"text",rounded:"",onClick:a=>{e.value="",o()}},null,8,["class","onClick"])])]),body:l(({data:e})=>[(r(!0),y(te,null,ee(e.categories,(o,a)=>(r(),g($,{value:s(u).getPrettyCategory(o),class:v([s(u).getColorCategory(o),"flex items-center mr-2 mb-2"]),key:a,rounded:""},null,8,["value","class"]))),128))]),_:1}),t(p,{class:"min-w-[100px]",header:"Ruolo",field:"role",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:l(({filterModel:e,filterCallback:o})=>[n("div",me,[t(F,{class:"w-[100px]",modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,o],options:s(q)(),"option-label":"label","option-value":"value"},null,8,["modelValue","onUpdate:modelValue","options"]),t(d,{class:v(e.value?"":"invisible"),icon:"pi pi-filter-slash",variant:"text",rounded:"",onClick:a=>{e.value="",o()}},null,8,["class","onClick"])])]),body:l(({data:e})=>[t($,{value:s(G)(e.role),severity:s(H)(e.role)},null,8,["value","severity"])]),_:1}),t(p,{class:"w-[50px]","align-frozen":"right",frozen:""},{body:l(({data:e})=>[n("div",ve,[ae(t(d,{type:"button","aria-haspopup":"true","aria-controls":"overlay_menu",icon:"pi pi-arrow-right",text:"",rounded:"",as:"router-link",to:I(e.id)},null,8,["to"]),[[P,"Dettaglio",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","total-records","onSort","onPage","filters","loading"])}}}),_e={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 mt-2"},he={class:"font-semibold text-2xl mb-4"},Fe=S({__name:"UsersView",props:{code:{}},setup(B){const c=D([]),u=z(),{totalUsers:f}=T(u),h=function(){c.value=[{label:"Tutti gli utenti",route:{name:M.utenti}}]};return L(()=>{h()}),(w,U)=>(r(),y("div",null,[t(Y,{items:c.value},null,8,["items"]),n("div",_e,[n("div",he,b(s(f))+" "+b(s(f)==1?"Utente":"Utenti"),1)]),t(fe,{"is-partner":!!w.code},null,8,["is-partner"])]))}});export{Fe as default};
